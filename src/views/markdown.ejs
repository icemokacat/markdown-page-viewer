<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <link rel="stylesheet" href="/public/css/reset.css">
    <link rel="stylesheet" href="/public/css/github-markdown-min.css">
    <link rel="stylesheet" href="/public/css/markdown-page.css">
    <link rel="stylesheet" href="/public/css/pdf.css">

    <link rel="icon" href="/public/favicon.ico" type="image/x-icon">

    <style>

    </style>
</head>
<body>

    <main>
        <aside>
            <nav>
                <h2>
                    <p id="welcome">ğŸ“º API Collections</p>
                </h2>
                <ul class="index" id="collections">
                    <%- navHtml %>
                </ul>
            </nav>
            <div class="func">
                <button type="button" id="pdfDownBtn">ğŸ’¾ PDF Download</button>
            </div>
        </aside>

        <article class="markdown-body" id="contents">
            <%- markdownData %>
        </article>
    </main>

    <!-- UI Event -->
    <script>
        const collections = document.getElementById('collections');
        const links = collections.querySelectorAll('a');

        links.forEach(link => {
            link.addEventListener('click', () => {

                // sub menuê°€ ìˆìœ¼ë©´ active toggle
                if (link.nextElementSibling) {
                    links.forEach(link => {
                        link.classList.remove('active');
                    });
                    // í˜„ì¬ a link ì— active ê°€ ìˆìœ¼ë©´ remove ì—†ìœ¼ë©´ add

                    // link.nextElementSibling ì˜ active ì—¬ë¶€ í™•ì¸
                    if(link.nextElementSibling.classList.contains('active')){
                        link.classList.remove('active');
                    } else {
                        link.classList.add('active');
                    }
                                    
                    link.nextElementSibling.classList.toggle('active');
                } // end of if (link.nextElementSibling)
            }); // end of addEventListener
        });

        // í˜ì´ì§€ ë¡œë”© í›„ active ëœ a link ìˆìœ¼ë©´ ë¶€ëª¨ê°ì²´ì˜ ul active
        // <ul class='submenu'>
        //     <li>
        //         <a></a>
        //     </li>
        // </ul>
        // ì˜ í˜•íƒœì´ê¸° ë•Œë¬¸ì— a ë§í¬ì— active ê°€ ìˆìœ¼ë©´ ë¶€ëª¨ê°ì²´ë¥¼ ì°¾ì•„ ul ì´ë©´ active ë¥¼ ì¶”ê°€
        // ì´í›„ ë¶€ëª¨ì˜ ulì„ ì°¾ì•„ active ê°€ ìˆìœ¼ë©´ ë¶€ëª¨ì˜ ë¶€ëª¨ì¸ a ì— active ë¥¼ ì¶”ê°€
        // nav ê¹Œì§€ ê°€ë©´ ë©ˆì¶¤
        links.forEach(link => {
            if(link.classList.contains('active')){
                findAndActiveSubmenu(link);
            }
        });

        function findAndActiveSubmenu(target){
            if(target){
                let parent = target.parentElement;
                if(parent && parent.classList && parent.classList.contains('submenu')){
                    parent.classList.add('active');
                    parent.parentElement.querySelector('a').classList.add('active');
                    findAndActiveSubmenu(parent);
                }else{
                    // í¬í•¨ì•ˆë˜ ìˆìœ¼ë©´ í•œë‹¨ê³„ ë” ì˜¬ë¼ê°€ì„œ ì°¾ìŒ
                    findAndActiveSubmenu(parent);
                }

                // nav ì—˜ë ˆë©˜íŠ¸ì´ë©´ ì¢…ë£Œ
                if(parent && parent.parentElement && parent.parentElement.tagName === 'NAV'){
                    return;
                }
            }else{
                return;
            }
        }

        // article ì— ë§¨ë¨¼ì € ë‚˜ì˜¤ëŠ” h ì—˜ë ˆë©˜íŠ¸ì˜ text ê°’ì„ titleë¡œ ì„¤ì •
        const article = document.getElementById('contents');
        // h1~6 ê¹Œì§€ì˜ ì—˜ë ˆë©˜íŠ¸ë¥¼ ì°¾ì•„ì„œ ì²«ë²ˆì§¸ë¡œ ë‚˜ì˜¤ëŠ” ì—˜ë ˆë©˜íŠ¸ì˜ text ê°’ì„ titleë¡œ ì„¤ì •
        const helement = article.querySelector('h1, h2, h3, h4, h5, h6');
        if(helement){
            const title = helement.textContent;
            document.title = title;
        }        

        // #welcome í´ë¦­ì‹œ "/" ë¡œ ì´ë™
        const welcome = document.getElementById('welcome');
        welcome.addEventListener('click', () => {
            location.href = '/';
        });
    </script>

    <script src="/public/js/pdfdown.js"></script>

    <!-- <script src="/public/js/NotoSansKR-VariableFont_wght-normal.js"></script> -->
</body>
</html>